---

- name: Verify grafana
  hosts: all
  gather_facts: false
  tasks:
    - name: Get service status
      ansible.builtin.systemd:
        name: grafana-server.service
        state: started
      register: service_status
      check_mode: true

    - name: Service assertion
      ansible.builtin.debug:
        msg: "{{ service_status.status.ActiveState }}"

    - name: Service assertion
      ansible.builtin.assert:
        that: service_status.status.ActiveState == "active"
